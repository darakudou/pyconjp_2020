
ã“ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã®URL
https://gitpitch.com/darakudou/pyconjp_2020

---

#### ãƒãƒ¼ãƒ é–‹ç™ºæ™‚ã«ã‚„ã£ã¦ãŠã„ãŸã»ã†ãŒè‰¯ã„ã“ã¨
#### Yuuki Nakajima

---
#### å¯¾è±¡
 
 - ã“ã‚Œã‹ã‚‰ãƒãƒ¼ãƒ é–‹ç™ºã‚’å§‹ã‚ã‚ˆã†ã¨ã„ã†äºº
 - ã¨ã‚Šã‚ãˆãšflake8ã—ã¦ã‚‹äºº(ã‚ˆãåˆ†ã‹ã£ã¦ãªã„) 
 - ã¨ã‚Šã‚ãˆãšblackã—ã¦ã‚‹äºº(ã‚ˆãåˆ†ã‹ã£ã¦ãªã„)

---

QUESTION

----

 - ã€‡ã€‡(ä»»æ„ã®å«Œãªæ€ã„å‡ºã®ã‚ã‚‹è¨€èªå)ã®ä»•äº‹ã‚’ã‚‚ã†ã—ãŸããªã„!
 - I don't want work for ***(any program what you hate!) anymore!

---

æŒ™æ‰‹ã—ã¦ä¸‹ã•ã„

raise your hands please âœ‹

---

å¿ƒã®ä¸­ã§!
only in your heart !

---

ã‚ãªãŸãŒãã®è¨€èªã‚’å«Œã„ãªã®ã¯ã²ã©ã„ã‚³ãƒ¼ãƒ‰ã«é–¢ã‚ã£ã¦ã²ã©ã„ç›®ã«ã‚ã£ãŸã›ã„ã¯ã‚ã‚Šã¾ã›ã‚“ã‹?

---

ã‚ˆãçŸ¥ã‚‰ãªã„äººãŒã‚ˆãåˆ†ã‹ã‚‰ãªã„ã¾ã¾æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã¯å¾€ã€…ã«ã—ã¦ã²ã©ã„ã‚‚ã®ã«ãªã‚‹ã®ã§ã¯ï¼Ÿ(çµŒé¨“è«‡)

---

- pythonã®æµè¡Œã¨å…±ã«èµ·ãã†ã‚‹æ‡¸å¿µ
  - ã‚ˆãçŸ¥ã‚‰ãªã„ã‘ã©Pythonã§ã‚„ã£ã¦ã¿ã‚ˆã†ãœï¼æ¡ˆä»¶ãŒå‡ºã¦ãã‚‹
  - ã²ã©ã„ã‚³ãƒ¼ãƒ‰ãŒå¢—ãˆã‚‹(çµ‚åˆŠå®Ÿè©±)
  - ã²ã©ã„ã‚³ãƒ¼ãƒ‰ã‚’å¼•ãå–ã£ã¦ã—ã¾ã†
  - Pythonã®ä»•äº‹ã¯ã‚‚ã†ã—ãŸããªã„ï¼

---

- ãƒãƒ™ãƒ«ã®å¡”ã¯ä½•æ•…å´©å£Šã—ãŸã®ã‹ï¼Ÿ
  - ä½œã£ã¦ã„ã‚‹äººã©ã†ã—ã§è¨€è‘‰ãŒé€šã˜ãªããªã£ãŸã‹ã‚‰  

![alt](assets/babel.jpg)

---

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã¨ã—ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¸€è²«æ€§ã‚’æŒãŸã›ã‚‹ã“ã¨ãŒå¤§äº‹!

---

- ã“ã“ã§è©±ã™ã“ã¨
  - ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ•´ãˆã‚‹ãŸã‚ã®è¦ç´„ã®ç´¹ä»‹
  - ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç´¹ä»‹
  - ã‚½ãƒ¼ã‚¹ã‚’å‹æ‰‹ã«ç›´ã—ã¦ãã‚Œã‚‹formatterã®ç´¹ä»‹ 

- ã“ã“ã§ã¯è©±ã•ãªã„ã“ã¨
  - è¨­è¨ˆãƒ¬ãƒ™ãƒ«ã§ã®ä¸€è²«æ€§ã‚„å¯èª­æ€§ã®è©±ã—

---

ã¿ãŸã„ãªè©±ã—ã‚’ã—ã‚ˆã†ã¨æ€ã£ã¦ã„ã¾ã—ãŸãŒã€‚ã€‚ã€‚

----

ã ã„ãŸã„é›‘èªŒã«æ›¸ã‹ã‚Œã¦ã¾ã™

![alt](assets/image_000_web_db_press.jpg)

> ç¾å ´ã®Python â”€â”€ ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºã‚‚ï¼ æ©Ÿæ¢°å­¦ç¿’ã‚‚ï¼<br>
>ã€ç¬¬1å›ã€‘é–‹ç™ºæ”¯æ´ãƒ„ãƒ¼ãƒ«ã§å®‰å…¨ã§åŠ¹ç‡çš„ã« â€¦â€¦ã‚³ãƒ¼ãƒ‰è§£æï¼Œå‹ãƒã‚§ãƒƒã‚¯ï¼Œã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ã®å®Ÿè·µçš„è¨­å®š<br>

https://www.fujisan.co.jp/product/1281680264/b/1987343/

---

ã‚ã¨å»å¹´ã®PyCon JP 2019ã§ã‚‚é¡ä¼¼ã®è©±é¡ŒãŒã‚ã‚Šã¾ã™

- Pythoné–‹ç™ºã‚’å††æ»‘ã«é€²ã‚ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«è¨­å®š
https://pycon.jp/2019/schedule?sessionId=151

---

### ã¡ã‚‡ã£ã¨é•ã†éƒ¨åˆ†
- formatterã®autopep8/yapfã®ç´¹ä»‹
- ã¨ã‚Šã‚ãˆãšblackã£ã¦æ­£ã—ã„ã®ï¼Ÿ
- pre-commitã®ç´¹ä»‹

---

çµè«–ï¼›
ã‚ˆãåˆ†ã‹ã‚‰ãªã‘ã‚Œã° pre-commitã§blackã‚’å‹•ã‹ã—ã¦flake8ã§ãƒã‚§ãƒƒã‚¯ã™ã‚Œã°OK

---

#### ç›®æ¬¡
  - ã‚³ãƒ¼ãƒ‰è¦ç´„PEP8ã¨ã¯ï¼Ÿ
  - flake8ã§ã‚½ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯
  - formatterã«ã‚ˆã‚‹check
  - ã¨ã‚Šã‚ãˆãšblackã¯æ­£ã—ã„ã®ã‹ï¼Ÿ
    - AutoPep, yapf, blackã®æ¯”è¼ƒ
  - pre-commitã§è‡ªå‹•é©å¿œ
  - ä»–ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç´¹ä»‹
---
### ãŠå‰èª°ã‚ˆ

- Yuuki Nakajima 
- Pythonæ­´3å¹´10ãƒ¶æœˆãã‚‰ã„ï¼Ÿ
- Django(DjangoRestFramework)
- AWS
- å¿…è¦ãªã“ã¨ã¯ã‚°ã‚°ã‚ŠãªãŒã‚‰æ³¥ç¸„ã§ãªã‚“ã¨ã‹ã—ã‚ˆã†ã¨ã™ã‚‹ã‚¿ã‚¤ãƒ—
- è‡ªåˆ†ã®æ˜ ã£ãŸå†™çœŸãŒãƒã‚§ã‚­ã—ã‹ãªã„ã®ã§å…¬é–‹ã§ãã‚‹å†™çœŸã‚ã‚Šã¾ã›ã‚“


---
### ç½ªæ·±ãã‚³ãƒ¼ãƒ‰ã®ä¾‹

[001_spam_restaurant.py]
```
import sys
import datetime

def OrderMenu(menuName):
    return f"spam, {menuName}, spam and spam!"

if __name__ == "__main__":
    guets = "Viking"
    Input = sys.argv[1]
    orderdMenu = OrderMenu(Input);
    print(orderdMenu)
```

---

- ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã±ã£ã¨è¦‹ã§9ã¤ã®ç½ªãŒã‚ã‚‹
```
import sys
import datetime â† â‘ æœªä½¿ç”¨import
ã€€ã€€â‘¡ã€€ç©ºç™½è¡Œæ•°
def OrderMenu(menuName): â† â‘¢é–¢æ•°åã€å¼•æ•°å
    return f"spam, {menuName}, spam and spam!"
 â‘£ ç©ºç™½è¡Œæ•°
if __name__ == "__main__":
    guets = "Viking" â†ã€€â‘¤æœªä½¿ç”¨å¤‰æ•°
    Input = sys.argv[1] â†â‘¦å¤‰æ•°å
    orderdMenu = OrderMenu(Input); â†â‘§ã‚»ãƒŸã‚³ãƒ­ãƒ³
    print(orderdMenu)
```

â‘¨æ­£ã—ãå‹•ä½œã™ã‚‹
% python src/001_spam_restaulant.py egg
spam, egg, spam and spam!

---

PEP8ï¼šã‚³ãƒ¼ãƒ‰è¦ç´„ã®ç´¹ä»‹

---

ãã‚‚ãã‚‚PEPã£ã¦ãªã«ï¼Ÿ

What is a PEP?
PEP stands for Python Enhancement Proposal. A PEP is a design document providing information to the Python community, or describing a new feature for Python or its processes or environment. The PEP should provide a concise technical specification of the feature and a rationale for the feature.

https://www.python.org/dev/peps/pep-0001/#id34

---

>What is a PEP?
PEP stands for Python Enhancement Proposal.<br>

>PEPã¨ã¯Pythonæ”¹è‰¯ææ¡ˆã‚’æ„å‘³ã™ã‚‹èªã®é ­æ–‡å­—ã‚’å–ã£ã¦PEP

>A PEP is a design document providing information to the Python community, or describing a new feature for Python or its processes or environment.<br>

>PEPã¯ã€Pythonã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«æƒ…å ±ã‚’æä¾›ã™ã‚‹ã‹ã€Pythonã¾ãŸã¯ãã®ãƒ—ãƒ­ã‚»ã‚¹ã‚„ç’°å¢ƒã®æ–°æ©Ÿèƒ½ã‚’èª¬æ˜ã™ã‚‹è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã™ã€‚



---

PEPã®ä¾‹
- PEP11
- Removing support for little used platforms

```
Name: MS-DOS, MS-Windows 3.x
Unsupported in: Python 2.0
Code removed in: Python 2.1
```
https://www.python.org/dev/peps/pep-0011/

windows3.1ã§ã¯python2.0ã§ã‚µãƒãƒ¼ãƒˆã‚’åˆ‡ã‚‰ã‚ŒãŸã“ã¨ãŒåˆ†ã‹ã‚‹

---

PEPï¼˜ã¨ã¯
- Style Guide for Python Code 

- ã‚ãã¾ã§Style Guideãªã®ã§æ–‡æ³•ã§ã¯ãªã„
- éµå®ˆã—ãªãã¦ã‚‚å‹•ã

---
#### PEP8ã®ç´¹ä»‹ 

- æ—¥æœ¬èªã§èª­ã‚ã‚‹
  - https://pep8-ja.readthedocs.io/ja/latest/

- ä¸€è²«æ€§ã«ã“ã ã‚ã‚Šã™ãã‚‹ã®ã¯ã€ç‹­ã„å¿ƒã®ç¾ã‚Œã§ã‚ã‚‹
- ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã«ã¯ã‚¹ãƒšãƒ¼ã‚¹ï¼”ã¤ã‚’ä½¿ã„ã¾ã—ã‚‡ã†
- é–¢æ•°ã®åå‰ã¯å°æ–‡å­—ã§å˜èªã¯ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢(_)ã§ç¹‹ã
  - e.g goto_travel
- ã‚¯ãƒ©ã‚¹åã¯CapsWordsã§æ›¸ã
  - e.g class Itaewon():
- æ‹¬å¼§ã®åˆã‚ã®ç›´å¾Œã¨çµ‚ã‚ã‚Šã®ç›´å‰ã«ç©ºç™½ã‚’å…¥ã‚Œãªã„

---
#### ä»–ã®ã‚¬ã‚¤ãƒ‰

  - 1è¡Œã®é•·ã•ã¯79æ–‡å­—
  - importã®é †ç•ª
    - æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€è‡ªåˆ†ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    - ãã‚Œãã‚Œã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã™ã‚‹
  - ã‚³ãƒ¡ãƒ³ãƒˆãŒ2ã¤ä»¥ä¸Šã®æ–‡ã‹ã‚‰ãªã‚‹å ´åˆã€çµ‚ã‚ã‚Šã®ãƒ”ãƒªã‚ªãƒ‰ã®å¾Œã¯ã€äºŒã¤ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…¥ã‚Œã‚‹
    - ãŸã ã—ã€æœ€å¾Œã®æ–‡ã‚’é™¤ãã€‚
  - é–¢æ•°ã‚„ã‚¯ãƒ©ã‚¹ã¯2è¡Œãšã¤ç©ºã‘ã‚‹
  - ãƒ¡ã‚½ãƒƒãƒ‰ã¯1è¡Œç©ºã‘ã‚‹

---

### ã“ã®è¾ºã¾ã§æ„è­˜ã™ã‚‹ã®ã¯è¾›ã„ï¼

---

è¾›ã„ã®ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†

---
### flake8: ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚Œã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
  - Flake8ã¯ä»¥ä¸‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ©ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«:
    - PyFlakes
    - pycodestyle
    - Ned Batchelder's McCabe script

---

#### pyflakes

- ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯importã®ã¿ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„æœªä½¿ç”¨å¤‰æ•°ã‚’ãƒã‚§ãƒƒã‚¯

```
imaport datetime 

guests = "Vaiking"
```
```
% pyflakes src/001_spam_restaulant.py
src/001_spam_restaulant.py:2:1 'datetime' 
imported but unused
src/001_spam_restaulant.py:5:5 local variable
 'guests' is assigned to but never used
```
---

#### pycodestyle

 - ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
 - æ”¹è¡Œã¨ã‹ç©ºç™½ã®ä½ç½®ã¨ã‹ã‚’ãƒã‚§ãƒƒã‚¯

```
% pycodestyle src/001_spam_restaulant.py
src/001_spam_restaulant.py:4:1: E302
 expected 2 blank lines, found 1
src/001_spam_restaulant.py:5:22: W291
 trailing whitespace
src/001_spam_restaulant.py:8:1: E305
 expected 2 blank lines after class or function definition, found 1
src/001_spam_restaulant.py:9:10: E221 
multiple spaces before operator
src/001_spam_restaulant.py:10:34: E703
 statement ends with a semicolon
src/001_spam_restaulant.py:11:22: W292
 no newline at end of file
```

---

#### mccabe 
  - è¤‡é›‘ã•ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹

[002_complex_code.py]
```
def order(order):

    menus = ["egg and spam", "bacaon and spam", "egg bacon and spam",]
    is_egg = False
    for menu in menus:
        if "egg" in order:
            is_egg = True
        if is_egg:
            for m in menus:
                if "egg" in m:
                    return m
    return "spam, spam, spam and spam"

if __name__ == "__main__":
    input = sys.argv[1]
    orderd_menu = order(imput);
    print(orderd_menu)

```
---
### è¤‡é›‘åº¦ãŒæ•°å­—ã§è¡¨ç¤ºã•ã‚Œã‚‹

```
% python -m mccabe --min 5 src/002_complex_code.py
2:0: 'order' 6
```

---
ã“ã®3ã¤ã‚’åˆä½“ã—ãŸã‚‚ã®ãŒflake8

---
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•
```
pip install flake8
pip install pep8-nameing   # namingã®ãƒã‚§ãƒƒã‚¯ã«ã¯ã“ã‚ŒãŒå¿…è¦
```

---

ä½¿ã„æ–¹â‘ 
```
% flake8 src/001_spam_restaulant.py 
src/001_spam_restaulant.py:2:1: F401 'datetime' imported but unused
src/001_spam_restaulant.py:4:1: E302 expected 2 blank lines, found 1
....
```

---
ä½¿ã„æ–¹â‘¡ è¤‡é›‘åº¦ãƒã‚§ãƒƒã‚¯(defaultã§ã¯ç„¡åŠ¹)

```
% flake8 --max-complexity 5  src/002_complex_code.py
src/002_complex_code.py:2:1: C901 'order' is too complex (6)
```

---
ä½¿ã„æ–¹â‘¢ ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ã‚’é™¤å¤–ã™ã‚‹
```
% flake8 --ignore F401,E302,N802,F841,W291,E305,E221,N816,E703,W292,N803  src/001_spam_restaulant.py
```

â†’messageãŒæ¶ˆãˆãŸï¼

---
ä½¿ã„æ–¹â‘£

- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã™
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã«è¨­å®šã‚’æ›¸ãå‡ºã™
  - setup.cfg/.flake8/tox.iniç­‰ãƒ»ãƒ»ãƒ»

- å‚è€ƒ

.flake8 ã‚’è¿½åŠ 
```
[flake8]
ignore F401,E302,N802,F841,W291,E305,E221,N816,E703,W292,N803
exclude = .git,__pycache__,.pyc
max-complexity = 10
```

```
% flake8 src/001_spam_restaulant.py
```


---

- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã®ä¸€è¦§<br>  
https://flake8.pycqa.org/en/latest/user/error-codes.html

- pycodestyleã®ã‚‚ã®<br>
https://pep8.readthedocs.io/en/latest/intro.html#error-codes

- pep8-naming<br>>
https://pypi.org/project/pep8-naming/

---

#### ã¾ã¨ã‚
 - pythonã«ã¯PEP8ã¨ã„ã†æŒ‡é‡ãŒã‚ã‚‹
 - flake8ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å…¥ã‚Œã‚‹ã¨ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯ã§ãã‚‹
 - pep8-namingã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ä¸€ç·’ã«å…¥ã‚Œã‚‹ã¨å‘½åè¦å‰‡ã‚‚ãƒã‚§ãƒƒã‚¯

---

æ¯æŠœã

---

å¤ãªã®ã§å¯’ããªã‚‹è©±ã‚’ã—ã¾ã™

---

æœ¬å½“ã«ã‚ã£ãŸæ€–ã„è©±ã—(çµ‚åˆŠå®Ÿè©±)

---

ãªã«ã‚‚ã—ã¦ãªã„ã®ã«ã‚³ãƒ¼ãƒ‰ãŒå£Šã‚ŒãŸ
 - (ciã«é€šã‚‰ãªããªã£ãŸ)

---

[003_f_string_faild.py]
```
import sys

def order_menu(menu):
    if menu in ["egg", "bacon", "baked bean"]:
        return f"spam,{menu}, spam and spam!"
    return f"spam, spam, spam, spam, spam and spam"

if __name__ == "__main__":
    input  = sys.argv[1]
    print(order_menu(input))
```

---

ãŠã‚ã‹ã‚Šã§ã—ã‚‡ã†ã‹ï¼Ÿ

---

`return f"spam, spam, spam, spam, spam and spam"`

---

 - f"XX" ã¯ç¢ºã‹ã«"XX"ã¨åŒã˜ãªã®ã§ç„¡æ„å‘³
 - pycodestyleã§ã¯ã“ã®æ›¸ãæ–¹ã¯æ¤œçŸ¥ã•ã‚Œã¦ã„ãªã‹ã£ãŸ
 - pyflakesã®2.2.0(Apr 10,2020)ã‹ã‚‰ã“ã‚Œã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ 
 - ãã®çµæœã‚ã‚‹æ—¥çªç„¶ã‚½ãƒ¼ã‚¹ãŒè½ã¡ã‚‹è‡ªä½“ã«ï¼ï¼ï¼
 - ciã§ã¯å¸¸ã«æœ€æ–°ã®flake8ã‚’è½ã¨ã—ã¦ã„ãŸãŸã‚ã«èµ·ããŸæ‚²åŠ‡

---

- ciã§å‹•ã‹ã™ã¨ãã¯flake8ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ãŸæ–¹ãŒã„ã„ã‹ã‚‚ï¼Ÿ
- æ€¥ãã§ãªã‘ã‚Œã°ç›´ã™ã®ãŒæ­£ã—ã„(ã‚ã‚‹ã¹ãè«–)

---

è©±ã‚’æˆ»ã—ã¾ã™

---
ã“ã‚Œã§ã‚½ãƒ¼ã‚¹ã®ãƒã‚§ãƒƒã‚¯ã¯OK

----

ã„ã¡ã„ã¡æ›´æ–°ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«å…¨éƒ¨ç›´ã™ã®ã—ã‚“ã©ã„

---

### formatterã§formatã—ã‚ˆã†

---
- formaterã¨ã¯
  - ã‚½ãƒ¼ã‚¹ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦ãã‚Œã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª 

---

- ã‚³ãƒ¼ãƒ‰ã‚’è‰¯ã„æ„Ÿã˜ã«ç›´ã—ã¦ãã‚Œã‚‹
   - ã©ã“ã§æ”¹è¡Œã™ã‚Œã°ã„ã„ã‹
   - ã†ã£ã‹ã‚Šå…¥ã‚Œã¦ã—ã¾ã£ãŸç©ºç™½ã¨ã‹ 

---

```
count = get_spanish_inquisition_weapons_count("fear", "surprise", "ruthless efficiency", "fanatical devotion to the Pope", "nice red uniforms"):

def get_spanish_inquisition_weapons_count(*args):
    return len(*args) - 1 
```

â†“ã€€è‰¯ã„æ„Ÿã˜ã«æ”¹è¡Œã—ã¦ãã‚Œã‚‹(blackã§ã®ä¾‹)

```
count = get_spanish_inquisition_weapons_count(
    "fear",
    "surprise",
    "ruthless efficiency",
    "fanatical devotion to the Pope",
    "nice red uniforms",
)


def get_spanish_inquisition_weapons_count(*args):
    return len(*args) - 1
```

---

ã‚°ã‚°ã‚‹ã¨å‡ºã¦ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- black: ã‚¹ã‚¿ãƒ¼æ•° 17.1K(2020/08/15)
  - https://github.com/psf/black
- yapf: ã‚¹ã‚¿ãƒ¼æ•° 10.9k(2020/08/15)
  - https://github.com/google/yapf
- autopep8: ã‚¹ã‚¿ãƒ¼æ•° 3.5k(2020/08/15)
  - https://github.com/hhatto/autopep8

---
#### autopep8

- pep8ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ã«æº–æ‹ ã—ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
- pycodestyleã‚’ä½¿ã£ã¦ã„ã‚‹
- pycodestyleã«ã¯ãªã„å•é¡Œã®ä¿®æ­£ã‚‚è¡Œã£ã¦ã„ã‚‹
- aggressiveãƒ¬ãƒ™ãƒ«ã‚’æŒ‡å®šã—ã¦ãã‚Œã«ã‚ˆã£ã¦ä¿®æ­£å†…å®¹ãŒç•°ãªã‚‹
- Python2.7/Python3.4ã‹ã‚‰ä½¿ãˆã‚‹
- æœªä½¿ç”¨importã‚„å¤‰æ•°ã¯æ¶ˆã—ã¦ãã‚Œãªã„ 

---

ä½¿ã„æ–¹â‘ 

`pip install autopep8`

- --inplaceã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã™ã‚‹
- åŸºæœ¬ã¯ç©ºç™½ã«é–¢ã™ã‚‹ä¿®æ­£ã®ã¿
`autopep8 --in-place src/004_autopep_sample.py`
----

ä½¿ã„æ–¹â‘¡

--agressiveã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ä¿®æ­£å†…å®¹ãŒå¢—ãˆã‚‹

`autopep8 --in-place --agressive src/004_
autopep_sample.py`

--agressiveã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’2ã¤ã¤ã‘ã‚‹ã¨ä¿®æ­£å†…å®¹ãŒã‚‚ã£ã¨å¢—ãˆã‚‹

`autopep8 --in-place --agressive --agressive
 src/004_autopep_sample.py`

---

#### ã‚¨ãƒ©ãƒ¼ã®ä¸€è¦§ã¯ã“ã¡ã‚‰ã«è¨˜è¼‰

https://github.com/hhatto/autopep8#features

---

### yapf

- googleè£½ã®Formatter
- PEP8ã«æº–æ‹ ã—ãŸã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ã„ã¨ã¯é™ã‚‰ãªã„
- end all holy wars about formatting
  - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«é–¢ã™ã‚‹å…¨ã¦ã®è–æˆ¦ã‚’çµ‚ã‚ã‚‰ã›ã‚‹
- ã‚„ãŸã‚‰ç´°ã‹ãè¨­å®šã§ãã‚‹
- Python2.7/Python3.6ã€œ
- æœªä½¿ç”¨å¤‰æ•°ã‚„importã¯æ¶ˆã—ã¦ãã‚Œãªã„

---

### è¨­å®šæ–¹æ³•

```
[yapf]
based_on_style = pep8/google/yapf/facebook
spaces_before_comment = 4
split_before_logical_operator = true
```

- 58é …ç›®ãã‚‰ã„è¨­å®šã§ãã‚‹
  - ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®æ•°
  - æ–‡æœ«ã®ã‚»ãƒŸã‚³ãƒ­ãƒ³ã‚’è¨±å¯ã™ã‚‹ã‹
  -  ç­‰ã€…ãƒ»ãƒ»ãƒ»

----

#### ä½¿ã„æ–¹

`yapf --i --style='{DISABLE_ENDING_COMMA_HEURISTIC=True}' src/005_yapf_sample.py`

```
one = "two";
```
â†“â†“â†“
```
one = "two"
```
---

### black

- ã¾ã ãƒ™ãƒ¼ã‚¿ç‰ˆã¨ã¯æ›¸ã„ã¦ã‚ã‚‹ãŒå¤§ããªå¤‰æ›´ã¯äºˆå®šã•ã‚Œã¦ã„ãªã„ã¨ã®ã“ã¨
- å¦¥å”ã®ãªã„pythonã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
- yapfã®ã‚ˆã†ã«ç´°ã‹ã„è¨­å®šãŒå‡ºæ¥ãªã„
- installå‡ºæ¥ã‚‹ã®ã¯Python3.6ä»¥é™ã®ç’°å¢ƒã®ã¿
- æŒ‡å®šã™ã‚Œã°2ç³»ã®ã‚³ãƒ¼ãƒ‰ã‚‚ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚‰ã—ã„(æœªç¢ºèªï¼‰
- æœªä½¿ç”¨å¤‰æ•°ã‚„importã¯æ¶ˆã—ã¦ãã‚Œãªã„

---
#### ä½¿ã„æ–¹â‘ 

`pip install black`

`black {source_file_or_directory}`

---
### ä½¿ã„æ–¹â‘¡

- ãƒ•ã‚¡ã‚¤ãƒ«ã®é™¤å¤–
- ï¼‘è¡Œã®æœ€å¤§å€¤ã®è¨­å®š
- pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š

---

- blackã‚’ã‹ã‘ã¦ã‚‚flake8ã‚’é€šã‚‰ãªã„ãƒã‚§ãƒƒã‚¯ãŒã‚ã‚‹
- flake8ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã‚’é™¤å¤–ã™ã‚Œã°OK(blackã®å…¬å¼ã‚ˆã‚Š))

```
[flake8]
max-line-length = 90 
ignore = E203, E501, W503
```


---

005_conflict_black_flake8
```
# E203 Whitespace before ':'
name_lists = ["tarou", "hanako", "ichitarou", ""]
a = name_lists[1 + 1 :]

# E501 line too long (XX > 79 characters)
name = "jyugemujyugemu gokounosurikire kaijyarisuigyono suigyoumatu unnkoumatu."

# W503 line break before binary operator
income = (3
          + 4)
```

----

ã¾ã¨ã‚
- formatterã«ã¯æœ‰åã©ã“ã¨ã§ï¼“ã¤ã‚ã‚‹
 - black
    - ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®è¨­å®šãŒæŒ‡å®šã§ããªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã‹ãˆã£ã¦ç´°ã‹ã„è«–äº‰ã‚’å°ã˜è¾¼ã‚ã‚‹
 - yapf
    âˆ’ ç´°ã‹ã„è¨­å®šã‚’å……å®Ÿã•ã›ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¯ã«ã©ã‚“ãªè¨­å®šã§ã‚‚ä½œã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
 - autopep8
    - pep8ã«å¾“ã†ã“ã¨ã‚’æ˜¯ã¨ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒª
      - è¨­å®šã¯ç´°ã‹ãè¡Œã†ã“ã¨ãŒå‡ºæ¥ã‚‹

---
æœªä½¿ç”¨importã‚„æœªä½¿ç”¨å¤‰æ•°ã®æ¶ˆã—æ–¹

 - autflakeã‚’ã‹ã‘ã‚‹

`pip install autflake` 

 `autoflake --in-place --remove-all-unused-imports --remove-unused-variables`

---


### ã‚³ãƒ©ãƒ 

- 1è¡Œã®é•·ã•ã¯ãªã«ãŒæ­£ã—ã„ã®ã ã‚ã†ã‹?
  - PEP8: 79æ–‡å­— 
  - black: 88æ–‡å­—(defautl)
  - yapf: 80æ–‡(defautl)
  - autopep8: 79æ–‡å­—

---

- å€‹äººçš„ã«ã¯å¤§ãã„ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã§è¦‹ã‚‹ãªã‚‰90æ–‡å­—ä»¥ä¸Šã‚ã£ã¦ã‚‚ã„ã„ãŒ
- ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã ã‘ã ã¨80æ–‡å­—ãã‚‰ã„ãŒè¦‹ã‚„ã™ã„ã‹ã‚‚
- ã‚„ã£ã±ã‚Š79æ–‡å­—ã¯å°‘ãªã„æ°—ãŒã™ã‚‹

---

æœ¬ç·¨ã«æˆ»ã‚Šã¾ã™

---
pre-commitã§formatterã‚’è‡ªå‹•çš„ã«å‹•ã‹ãã†

 ---

formatterãŒæ±ºã¾ã£ãŸã“ã¨ã§ã€ç´°ã‹ã„ãƒ«ãƒ¼ãƒ«ã‚‚æ±ºã¾ã‚Šã¾ã—ãŸ

 ---

ã§ã‚‚ã€é¸ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«ã‚’formatterã«ã‹ã‘å¿˜ã‚Œã¦commit & pushã—ã¦ã—ã¾ã£ãŸã‚‰ï¼Ÿ

---

![alt](assets/babel.jpg)

---

ã†ã£ã‹ã‚ŠãƒŸã‚¹ã‚’é˜²ããŸã‚ã«ã¯pre-commitã‚’æ¡ç”¨ã—ã¦ã¿ã¾ã—ã‚‡ã†

---

pre-commitã¨ã¯ãƒ»ãƒ»ãƒ»ãƒ»
 - gitãƒ•ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
 - ã‚³ãƒŸãƒƒãƒˆæ¯ã«ãƒ•ãƒƒã‚¯ã‚’å®Ÿè¡Œ
   - ã‚»ãƒŸã‚³ãƒ­ãƒ³ã®æ¬ è½ã‚„æœ«å°¾ã®ç©ºç™½ãªã©ã®ã‚³ãƒ¼ãƒ‰ã®å•é¡Œã‚’è‡ªå‹•çš„ã«æŒ‡æ‘˜
 - ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã¯å¤‰æ›´å†…å®¹ã«é›†ä¸­ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼å‡ºæ¥ã‚‹ 

---
ä½¿ã„æ–¹
`pip install pre-commit`

- .pre-commit-config.yamlã‚’ç”¨æ„ã—ã¦ãã®ä¸­ã«å®Ÿè¡Œã—ãŸã„å†…å®¹ã‚’æ›¸ã

```
repos:
-   repo: https://github.com/psf/black
    rev: statble 
    hooks:
    -   id: black
```

---


ä»–ã«ã‚‚è¨­å®šã—ãŸæ–¹ãŒè‰¯ã„ç‰©

- mypy
  - å¼•æ•°ãªã©ã®å‹ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã£ã¦ãã‚Œã‚‹
- isort
  - importé †ã‚’ç›´ã—ã¦ãã‚Œã‚‹ã‚‚ã®

---

ã¾ã¨ã‚
- pre-commitã§ã‚³ãƒŸãƒƒãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§blacï½‹ã‚„ãã®ä»–ã®ãƒ„ãƒ¼ãƒ«ã‚’å‹•ã‹ã›ã‚‹
- è¨­å®šã—ã¦ãŠãã¨å¿˜ã‚Œãªã„ã®ã§ã‚„ã£ã¦ãŠãã¾ã—ã‚‡ã†
- ciã¨ã‹ã§ã‚‚ã„ã„ã¨ã¯æ€ã†

---

- ãŠã¾ã‘
æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«blackã‚’ã‹ã‘ãŸã‚‰ã©ã†ãªã£ã¡ã‚ƒã†ã®ï¼Ÿ

- æ¥­å‹™ã§ä½¿ã£ã¦ã„ã‚‹æŸã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒªã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆDjango)
 - 1247ãƒ•ã‚¡ã‚¤ãƒ«
 - 30Apps
 - flake8ã«ã‚ˆã‚‹ãƒã‚§ãƒƒã‚¯ã¯å¸¸ã«å®Ÿæ–½ 

â†’ä½•ã‚‚è€ƒãˆãšã«æ‰‹å…ƒã§black

---

```
All done! âœ¨ ğŸ° âœ¨
429 files reformatted, 786 files left unchanged.
```

- å·®åˆ†ã®ã»ã¨ã‚“ã©ã¯migratefileã§ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¸ã®å¤‰æ›éƒ¨åˆ†
- flake8ã§ã‚³ãƒ¼ãƒ‰ã®ä¸€è²«æ€§ãŒä¿ãŸã‚ŒãŸã‚³ãƒ¼ãƒ‰ãªã‚‰formatterã‚’å°å…¥ã—ã¦ã‚‚ã„ã‘ãã†

---

æ—©ã„æ®µéšã‹ã‚‰flake8&formatter&pre-commitã§Pythonã‚³ãƒ¼ãƒ‰ã®ä¿å®ˆã®å®‰å®šåŒ–ã‚’é€²ã‚ã¾ã—ã‚‡ã†ï¼

---

## Excelsiorï¼

-- å¸¸ã«å‘ä¸Šã‚’ï¼

---

### the end

---

- QA
